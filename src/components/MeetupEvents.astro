---
// MeetupEvents component to display events from a single data source
import { getPastEvents, formatEventDate } from '../data/events';

// Get past events to fill the grid
const allEvents = getPastEvents();
---

<div class="bg-gray-900 py-24 sm:py-32">
  <div class="mx-auto max-w-7xl px-6 lg:px-8">
    <div class="mx-auto max-w-2xl text-center">
      <h2
        class="text-4xl font-semibold tracking-tight text-balance text-white sm:text-5xl"
      >
        Past Events
      </h2>
    </div>

    <div
      class="mx-auto mt-16 grid max-w-2xl auto-rows-fr grid-cols-1 gap-8 sm:mt-20 lg:mx-0 lg:max-w-none lg:grid-cols-3"
    >
      {
        allEvents.map((event) => (
          <article
            class="relative isolate flex flex-col justify-end overflow-hidden rounded-2xl bg-gray-800 px-8 pt-80 pb-8 sm:pt-48 lg:pt-80 bg-cover bg-no-repeat bg-center"
            style={event.bgPath ? `background-image: url(${event.bgPath})` : ''}
          >
            <div class="absolute inset-0 -z-10 bg-gradient-to-br from-slate-500/50 to-slate-800/80" />
            <div class="absolute inset-0 -z-10 rounded-2xl inset-ring inset-ring-white/10" />

            <div class="flex flex-wrap items-center gap-y-1 overflow-hidden text-sm/6 text-gray-300">
              <time datetime={new Date(event.date).toISOString()} class="mr-8">
                {formatEventDate(event.date)}
              </time>
              <div class="-ml-4 flex items-center gap-x-4">
                <svg
                  viewBox="0 0 2 2"
                  class="-ml-0.5 size-0.5 flex-none fill-gray-300/50"
                >
                  <circle r="1" cx="1" cy="1" />
                </svg>
                <div class="flex gap-x-2.5">
                  <div class="size-6 flex-none rounded-full bg-slate-500/20 flex items-center justify-center">
                    <svg
                      class="w-4 h-4 text-slate-400"
                      fill="currentColor"
                      viewBox="0 0 20 20"
                    >
                      <path
                        fill-rule="evenodd"
                        d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z"
                        clip-rule="evenodd"
                      />
                    </svg>
                  </div>
                  {event.currentRSVPs} registered
                </div>
              </div>
            </div>

            <h3 class="mt-3 text-lg/6 font-semibold text-white">
              <span class="absolute inset-0" />
              {event.title}
            </h3>

            {event.description && (
              <p class="mt-2 text-sm text-white line-clamp-3">
                {event.description}
              </p>
            )}

            {(event.slides || event.recording) && (
              <div class="mt-4 flex gap-2">
                {event.slides && (
                  <a
                    href={event.slides}
                    target="_blank"
                    rel="noopener noreferrer"
                    class="inline-flex items-center gap-1 text-xs text-slate-400 hover:text-slate-300"
                  >
                    <svg
                      class="w-3 h-3"
                      fill="currentColor"
                      viewBox="0 0 20 20"
                    >
                      <path
                        fill-rule="evenodd"
                        d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.415L11 9.586V6z"
                        clip-rule="evenodd"
                      />
                    </svg>
                    Slides
                  </a>
                )}
                {event.recording && (
                  <a
                    href={event.recording}
                    target="_blank"
                    rel="noopener noreferrer"
                    class="inline-flex items-center gap-1 text-xs text-slate-400 hover:text-slate-300"
                  >
                    <svg
                      class="w-3 h-3"
                      fill="currentColor"
                      viewBox="0 0 20 20"
                    >
                      <path
                        fill-rule="evenodd"
                        d="M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8v4a1 1 0 001.555.832l3-2a1 1 0 000-1.664l-3-2z"
                        clip-rule="evenodd"
                      />
                    </svg>
                    Recording
                  </a>
                )}
              </div>
            )}
          </article>
        ))
      }
    </div>
  </div>
</div>
